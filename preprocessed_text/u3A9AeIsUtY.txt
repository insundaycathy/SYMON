in the morning of her first day at school, mary is in a foul mood because she doesn't want to go. she wants frank to continue homeschooling her, but he says he's taught her everything he knows and she needs the experience. as soon as he sees the reluctant sulking mary off to school, he's confronted by roberta, who's his landlady and friend and cares deeply for mary. she tells him to get in his car and bring mary back before it's too late, afraid that she will be taken away once everyone realizes she's a child prodigy. frank tries to calm her down, saying mary needs friends and social skills. roberta isn't convinced, but there's nothing she can do, so she lets go at school. mary is shown bored out of her mind as bonnie, her teacher, goes over first grade math problems with the rest of the class. mary eventually speaks up, making it known that the lack of challenge is beyond her ability to bear. bonnie warns her for speaking out of turn, and starts asking her increasingly difficult arithmetic problems to make a point to her surprise, mary answers the mall after recess, the principal requests a walk-in observation of bonnie's class. as soon as she introduces herself to the children, mary demands to know if she's the boss, and upon confirmation, demands that she call frank right away and tell him to get her out of there. when frank comes to pick mary up, bonnie catches up to him on the front yard and tells him she thinks mary might be a gifted child. frank chalks it off to some simple algorithm he's taught her and walks away before bonnie can discuss the matter with him any further. mary has lived with frank, a former college professor turned boat repairman, ever since. in the class, one day, bonnie gives mary a hard test, and she can do it all very fast. bonnie then does her own research and finds out that mary's mother, diane, had been a promising mathematician dedicated to the navy or stokes problem, which is one of the unsolved millennium prize problems, before taking her own life when mary was just six months old. on the school bus one day, mary witnesses bullying, and she stands up for the victim, breaking the nose of the bully who's five years her senior. frank is called to the principal's office where she tells him she can get a full ride from mary at a nearby school for the gifted. frank refuses the offer on the grounds that she wants mary to have a normal childhood. evelyn, frank's mother and mary's grandmother, shows up at frank's door soon after and meets mary for the first time. she's a rich, bossy english woman whose ideas of life and ambition frank clearly disagrees with. evelyn believes that mary is a one in a billion mathematical prodigy who should be specifically tutored in preparation for a life devoted to mathematics, much as diane was. however, frank is animate that his sister would want mary to be in a normal public school and have the childhood she didn't have. she criticizes frank's lifestyle choices and demands to take mary away with her to boston. when frank disagrees, she takes him to court. in court, frank argues that evelyn's parenting deprived diane of a normal life evelyn had sent away a boy diane was in love with, which was when diane first attempted suicide. evelyn argues that frank is in no position to be a guardian, working a low-paying job without health insurance. evelyn takes mary to the boston university. the professor is so surprised that mary can find the mistake in his math problem and solve it. worried that the judge will rule against him and he will lose mary completely. frank accepts a compromise brokered by his lawyer, greg cohen, that sees mary placed in foster care and attend the private school where evelyn wants to have her enrolled. the foster parents live 25 minutes from frank's home, and frank will be entitled to schedule visits, and mary will be able to decide where she wants to live. after her 12th birthday, mary burst into tears and is devastated at being placed in foster care. and her foster father says she refuses to see frank. when bonnie sees a picture of fred up for adoption, she alerts frank. frank retrieves the cat from the pound, and learning that fred was brought in due to allergy issues, realizes that evelyn, who is allergic to cats, is overseeing mary's education in the guest house of mary's foster home. he then reveals to evelyn, who had been a mathematician herself, that diane had solved the navy or stokes problem, but stipulated that the solution was to be withheld until evelyn's death. knowing that it meant everything to evelyn to see diane solve the problem, frank offers evelyn the opportunity to publish diane's work if she drops her objection to him having custody of mary. evelyn agrees. evelyn is shocked and in tears when she sees all of diane's letters showing how she hated her. the film ends with mary back in frank's custody, returning to public school and socializing with children her age while taking college level courses. you 